<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kedai Anteiku</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  body { padding: 20px; }
  .menu-item { cursor: pointer; border: 1px solid #ddd; padding: 10px; margin: 5px; border-radius: 10px; }
  .menu-item:hover { background-color: #f0f0f0; }
</style>
</head>
<body>

<h2>Kedai Anteiku - Kasir</h2>
<div class="row">
  <div class="col-md-6">
    <h4>Menu</h4>
    <div class="menu-item" onclick="addToCart('Dimsum Chili Oil', 15000)">Dimsum Chili Oil - Rp 15.000</div>
    <div class="menu-item" onclick="addToCart('Dimsum Mentai Keju', 20000)">Dimsum Mentai Keju - Rp 20.000</div>
    <div class="menu-item" onclick="addToCart('Nasi Tempong', 18000)">Nasi Tempong - Rp 18.000</div>
  </div>
  <div class="col-md-6">
    <h4>Keranjang</h4>
    <ul id="cart" class="list-group"></ul>
    <h5 class="mt-3">Total: Rp <span id="total">0</span></h5>
    <input type="number" id="uang" class="form-control mt-2" placeholder="Uang Diterima">
    <select id="metode" class="form-control mt-2">
      <option value="Cash">Cash</option>
      <option value="QRIS">QRIS</option>
    </select>
    <button class="btn btn-success mt-3" onclick="checkout()">Selesai</button>
  </div>
</div>

<script>
let cart = [];
let total = 0;

function addToCart(name, price) {
  cart.push({ name, price });
  total += price;
  updateCart();
}

function updateCart() {
  const cartList = document.getElementById("cart");
  cartList.innerHTML = "";
  cart.forEach((item, index) => {
    const li = document.createElement("li");
    li.className = "list-group-item d-flex justify-content-between align-items-center";
    li.innerHTML = `${item.name} - Rp ${item.price.toLocaleString()} <button class="btn btn-sm btn-danger" onclick="removeFromCart(${index})">X</button>`;
    cartList.appendChild(li);
  });
  document.getElementById("total").innerText = total.toLocaleString();
}

function removeFromCart(index) {
  total -= cart[index].price;
  cart.splice(index, 1);
  updateCart();
}

function checkout() {
  const uang = parseInt(document.getElementById("uang").value) || 0;
  const metode = document.getElementById("metode").value;
  const kembalian = uang - total;
  const now = new Date();
  const tanggal = now.toLocaleDateString("id-ID");
  const jam = now.toLocaleTimeString("id-ID");

  const data = {
    tanggal: tanggal,
    jam: jam,
    total: total,
    uang: uang,
    kembalian: kembalian,
    metode: metode,
    items: cart
  };

  fetch("https://script.google.com/macros/s/AKfycbzSlYToRgYFRhkg_ZO3AwTVf0tj6wmPHdiTLNe-uyM_JRroGzWS1eO7VOwL7hEtKn6Jdw/exec", {
    method: "POST",
    mode: "no-cors",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  }).then(() => {
    alert("Transaksi tersimpan!");
    cart = [];
    total = 0;
    updateCart();
    document.getElementById("uang").value = "";
  }).catch(err => alert("Gagal menyimpan: " + err));
}
</script>

</body>
</html>
